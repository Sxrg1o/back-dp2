version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: back-dp2
    ports:
      - "8000:8000"
    environment:
      # Variables de entorno desde .env
      - DATABASE_URL=${DATABASE_URL:-sqlite+aiosqlite:///./app.db}
      - SECRET_KEY=${SECRET_KEY:-test_secret_key_for_testing_only}
      - ENVIRONMENT=${ENVIRONMENT:-development}
      - DEBUG=${DEBUG:-true}
    volumes:
      # Monta el c√≥digo fuente para hot-reload
      - .:/app
      # Persiste la base de datos SQLite
      - ./app.db:/app/app.db
    working_dir: /app
    command: uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
    restart: unless-stopped
    networks:
      - dp2-network

networks:
  dp2-network:
    driver: bridge
